"use strict";var canvas,cw,ch,boxSize,menuVisible=!0;function setupInteraction(){document.querySelector("#grid-size").addEventListener("input",function(t){updateGrid(),document.querySelector("#grid-size-readout").innerHTML=t.target.value},!1),document.querySelector("#autoplay-speed").addEventListener("input",function(t){autoPlayDuration=maxDuration-t.target.value,autoPlayTimer=autoPlayDuration,console.log(t.target.value,autoPlayDuration),autoPlayIndicator=0<t.target.value},!1),document.querySelector(".color-selectors").addEventListener("change",function(t){setBoxColors()},!1),document.querySelector("#save-btn").addEventListener("click",function(t){savePattern()},!1),document.addEventListener("keydown",function(t){if("Tab"===t.key&&(console.log("tab key man"),document.body.classList.add("user-is-tabbing")),"Shift"===t.key){var e=document.querySelector("#controls-container");menuVisible=menuVisible?(e.classList.remove("cp-visible"),e.classList.add("cp-hidden"),!1):(e.classList.remove("cp-hidden"),e.classList.add("cp-visible"),!0)}"r"===t.key.toLowerCase()&&boxes[activeBox].spin(),"q"===t.key.toLowerCase()&&randomizeBoxes(),"s"===t.key.toLowerCase()&&savePattern()},!1)}function getRndInteger(t,e){return Math.floor(Math.random()*(e-t+1))+t}var autoPlayTimer,autoPlayIndicator=!(window.onload=function(){setupInteraction()}),autoPlayDuration=0,maxDuration=110;function setup(){cw=window.innerWidth,ch=window.innerHeight,canvas=createCanvas(cw,ch),rectMode(CENTER),noStroke(),angleMode(DEGREES),initBoxes()}function mouseClicked(){boxes[activeBox].flip()}function draw(){for(var t=0;t<boxes.length;t++)boxes[t].xId<=xCount&&boxes[t].yId<=yCount&&(boxes[t].display(),boxes[t].hoverCheck());autoPlayIndicator&&autoToggle()}function autoToggle(){if(autoPlayTimer--,console.log(autoPlayTimer),autoPlayTimer<=0){for(var t;t=getRndInteger(0,boxes.length-1),1==boxes[t].toggled;);var e=getRndInteger(0,totalStates-1),o=boxRotation[getRndInteger(0,boxRotation.length-1)],i=getRndInteger(0,patternColors.length-1);boxes[t].pState=e,boxes[t].rState=o,boxes[t].cId=i,autoPlayTimer=autoPlayDuration}}function windowResized(){cw=window.innerWidth,ch=window.innerHeight,canvas=createCanvas(cw,ch),initBoxes()}function savePattern(){saveCanvas(canvas,"my_wonderful_pattern","jpg")}var previousBoxValues,bgColor,xCount,yCount,totalXCount,totalYCount,boxes=[],totalStates=5,boxRotation=[0,90,180,270],patternColors=[],activeBox=0;function initBoxes(){calcGrid(),setBoxColors(),createBoxes()}function calcGrid(){boxSize=document.querySelector("#grid-size").value;totalXCount=Math.ceil(window.innerWidth/80),totalYCount=Math.ceil(window.innerHeight/80),xCount=Math.ceil(window.innerWidth/boxSize),yCount=Math.ceil(window.innerHeight/boxSize)}function updateGrid(){calcGrid();for(var t=index=0;t<totalXCount;t++)for(var e=0;e<totalYCount;e++){var o=boxSize/2+t*boxSize,i=boxSize/2+e*boxSize;boxes[index].x=o,boxes[index].y=i,boxes[index].s=boxSize,index++}}function setBoxColors(){bgColor=document.querySelector("#bg-color").value,patternColors[0]=document.querySelector("#shape-color-01").value,patternColors[1]=document.querySelector("#shape-color-02").value,patternColors[2]=document.querySelector("#shape-color-03").value}function createBoxes(){for(var t=0,e=0;e<totalXCount;e++)for(var o=0;o<totalYCount;o++){var i=boxSize/2+e*boxSize,n=boxSize/2+o*boxSize;boxes[t]=new Box(i,n,boxSize,t,e,o),t++}}function randomizeBoxes(){for(var t=0;t<boxes.length;t++)boxes[t].pState=getRndInteger(0,totalStates-1),boxes[t].rState=boxRotation[getRndInteger(0,boxRotation.length-1)],boxes[t].cId=getRndInteger(0,patternColors.length-1)}function Box(t,e,o,i,n,a){this.x=t,this.y=e,this.s=o,this.pState=0,this.rState=0,this.hover=!1,this.cId=getRndInteger(0,patternColors.length-1),this.id=i,this.xId=n,this.yId=a,this.toggled=!1}Box.prototype.display=function(){var t=this.s/2;this.s;push(),translate(this.x,this.y),fill(bgColor),rect(0,0,this.s,this.s),this.hover&&(push(),colorMode(RGB,255,255,255,100),"ffffff"==bgColor?fill(0,0,0,20):fill(255,255,255,30),rect(0,0,this.s,this.s),pop()),fill(patternColors[this.cId]),rotate(this.rState),1===this.pState?arc(-t,0,this.s,this.s,270,90,PIE):2===this.pState?(arc(-t,-t,this.s,this.s,0,90,PIE),arc(t,t,this.s,this.s,180,270,PIE)):3===this.pState?(arc(-t,0,this.s,this.s,270,90,PIE),arc(t,0,this.s,this.s,90,270,PIE)):4===this.pState?arc(-t,-t,2*this.s,2*this.s,0,90,PIE):5===this.pState&&(rect(0,0,this.s,this.s),fill(bgColor),ellipse(0,0,this.s,this.s)),pop()},Box.prototype.hoverCheck=function(){var t=this.s/2;mouseX>this.x-t&&mouseX<this.x+t&&mouseY>this.y-t&&mouseY<this.y+t?(this.hover=!0,activeBox=this.id):this.hover=!1},Box.prototype.flip=function(){this.cId=getRndInteger(0,patternColors.length-1),0==this.pState?(this.rState=boxRotation[getRndInteger(0,boxRotation.length-1)],this.pState=getRndInteger(1,totalStates-1),this.toggled=!0):(this.pState++,this.pState>totalStates&&(this.pState=0,this.toggled=!1))},Box.prototype.spin=function(){this.rState+=90};